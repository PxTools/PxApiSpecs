openapi: '3.0.2'
info:
  title: PxApi
  version: '2.0'
  description: |
    This api lets you do 2 things; Find a table(Navigation) and use a table (Table).

    _Table below is added to show how tables can be described in yml._

    **Table contains status code this API may return**
    | Status code    | Description      | Reason                      |
    | -------        | -----------      | ---------------------       |
    | 200            | Success          | The endpoint has delivered response for the request                      |
    | 400            | Bad request      | If the request is not valid |
    | 403            | Forbiddn         | number of cells exceed the API limit |
    | 404            | Not found        | If the URL in request does not exist |
    | 429            | Too many request | Requests exceed the API time limit. Large queries should be run in sequence |
    | 50X            | Internal Server Error | The service might be down |

servers:
  - url: https://api.server.test/api/v2
tags:
 - name: Navigation
   description:  Find a table
 - name: Table 
   description: Use a table  
paths:
  /navigation:
      get:
        tags:
          - Navigation
        summary: Browse the database structure
        operationId: GetNavigationRoot
        parameters:
          - $ref: '#/components/parameters/language'
        responses:
          '200':
            description: Success
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/Folder'
                examples:
                  NavigateRoot:
                    $ref: '#/components/examples/navigation-root'
          '400':
            $ref: '#/components/responses/ErrorResponse400'
          '404':
            $ref: '#/components/responses/ErrorResponse404'            
          '429':
            $ref: '#/components/responses/ErrorResponse429'

  /navigation/{id}:
    get:
      tags:
        - Navigation
      summary: Gets navigation item with the given id.
      operationId: GetNavigationById
      parameters:
        - $ref: '#/components/parameters/id'
        - $ref: '#/components/parameters/language'
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Folder'
              examples:
                  Navigation-BE:
                    $ref: '#/components/examples/navigation-be'
        '400':
          $ref: '#/components/responses/ErrorResponse400'
        '404':
          $ref: '#/components/responses/ErrorResponse404'            
        '429':
          $ref: '#/components/responses/ErrorResponse429'

  /tables:
    get:
      tags:
        - Navigation
      summary: Endpoint for listing tables
      operationId: ListAllTables
      parameters:
        - $ref: '#/components/parameters/query'
        - $ref: '#/components/parameters/pastDays'
        - $ref: '#/components/parameters/include_discontinued'
        - $ref: '#/components/parameters/pageNumber'
        - $ref: '#/components/parameters/pageSize'
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TablesResponse'
              examples:
                  tables:
                    $ref: '#/components/examples/tablesResponse'
  /tables/{id}:
    get:
      tags:
        - Table
      summary: Endpoint to get table by {id}
      operationId: GetTableById
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Table'
        '400':
          $ref: '#/components/responses/ErrorResponse400'
        '404':
          $ref: '#/components/responses/ErrorResponse404'            
        '429':
          $ref: '#/components/responses/ErrorResponse429'                

  /tables/{id}/metadata:
    get:
      tags:
        - Table
      summary: Endpoint to get metadata about table by {id}
      description: |
        **Used for listing detailed information about a specific table**
        * List all variables and values and all other metadata needed to be able to fetch data

        * Also links to where to:
          + Fetch
          - Where to get information about codelists

        * 2 output formats
          + Custom json 
          - JSON-stat2 
      operationId: GetMetadataById
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TableMetadata'
            application/jsonstat:
              schema:
                $ref: '#/components/schemas/Dataset'    
            application/vnd.json-stat2+json:
              schema:
                externalDocs:
                  url: "https://json-stat.org/schema/"
        '400':
          $ref: '#/components/responses/ErrorResponse400'
        '404':
          $ref: '#/components/responses/ErrorResponse404'            
        '429':
          $ref: '#/components/responses/ErrorResponse429'
                            
  /tables/{id}/codelists:
    get:
      tags:
        - Table
      summary: List all codelists that are associated with the table 
      operationId: GetTableCodeLists
      parameters:
        - $ref: '#/components/parameters/language'
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CodeListsResponse'
        '400':
          $ref: '#/components/responses/ErrorResponse400'
        '404':
          $ref: '#/components/responses/ErrorResponse404'            
        '429':
          $ref: '#/components/responses/ErrorResponse429'                

  /tables/{id}/codelists/{codeListId}:
    get:
      tags:
        - Table
      summary: List information about the codelist that is associated with the table.
      operationId: GetTableCodeListById
      parameters:
        - $ref: '#/components/parameters/language'
        - $ref: '#/components/parameters/id'
        - $ref: '#/components/parameters/codeListId'
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CodeList'
        '400':
          $ref: '#/components/responses/ErrorResponse400'
        '404':
          $ref: '#/components/responses/ErrorResponse404'            
        '429':
          $ref: '#/components/responses/ErrorResponse429'                
    
components:
  parameters:
    language:
      name: lang
      in: query
      description: The language if the default is not what you want.
      required: false
      schema:
        type: string
        nullable: true
      examples:
        X1:
          value: en
          summary: For english
        X2:
          value: dk
          summary: For danish
    id:
      name: id
      in: path
      description: Id
      required: true
      schema:
        type: string
    codeListId:
      name: codeListId
      in: path
      description: Identifier for a code list
      required: true
      schema:
        type: string
    query:
      name: query
      in: query
      description: Selects only tables that that matches a criteria which is specified by the search parameter.
      required: false
      schema:
        type: string
      examples:
        X1:
          value: befolkning
          summary: Search for tables with name `befolkning`
    pastDays:
      name: pastDays
      in: query
      description: Selects only tables that was updated from the time of execution going back number of days stated by the parameter pastDays. Valid values for past days are integers between 1 and ?
      required: false
      schema:
        type: integer
        minimum: 1
      examples:
        X1:
          value: 5
          summary: Search for tables which has been updated in the last 5 days
    include_discontinued:
      name: includeDiscontinued
      in: query
      description: Decides if discontinued tables are included in response.
      required: false
      schema:
        type: boolean
        default: false
        example: false
    pageNumber:
      name: pageNumber
      in: query
      description: "Pagination: Decides which page number to return"
      required: false
      schema:
        type: integer
        default: 1
    pageSize:
      name: pageSize
      in: query
      description: "Pagination: Decides how many tables per page"
      required: false
      schema:
        type: integer
        #Default value depends on site?
  schemas:
    FolderContentItem:
      discriminator:
        propertyName: objectType
        mapping:
          heading: "#/components/schemas/Heading"
          folderinformation: "#/components/schemas/FolderInformation"
          table: "#/components/schemas/Table"
      type: object
      description: Navigation item.
      required:
        - "objectType"
        - "id"
        - "label"
      properties:
        objectType:
          type: string
          nullable: false
          description: One of heading, table, folder or folder-information
        id:
          type: string
          nullable: false
        label:
          type: string
          nullable: true
          description: Display text
        description:
          type: string
          nullable: true
          description: Longer text describing node.
        sortCode:
          type: string
          description: String for sorting the contents in folder
    Folder:
      type: object
      description: Folder item
      required:
        - "language"
        - "id"
        - "label"
        - "folderContents"
        - "links"
      properties:
        objectType:
          type: string
          nullable: false
          description: allways set to folder
        language:
          type: string
          description: The language code (ISO 639) for this response
        id:
          type: string
          nullable: true
          #nullable = true beacause root is empty
        label:
          type: string
          nullable: true
          description: Display text
        description:
          type: string
          nullable: true
          description: Longer text describing node.
        tags:
          type: array
          items:
            type: string
            description: tag for folder
          nullable: true
        folderContents:
          type: array
          items:
            $ref: '#/components/schemas/FolderContentItem'
          nullable: true
        links:
          type: array
          items:
            $ref: '#/components/schemas/Link'
          description: Links to ...
          nullable: true
    FolderInformation:
      allOf:
        - $ref: '#/components/schemas/FolderContentItem'
      type: object
      description: Folder information item
      required:
        - "links"
      properties:
            tags:
              type: array
              items:
                type: string
                description: tag for folder
              nullable: true
            links:
              type: array
              items:
                $ref: '#/components/schemas/Link'
              description: Links to ...
              nullable: true
    Heading:
      allOf:
        - $ref: '#/components/schemas/FolderContentItem'
      type: object
      description: Heading item
    Table:
      allOf:
        - $ref: '#/components/schemas/FolderContentItem'
      type: object
      description: Table item
      required:
        - "updated"
        - "firstPeriod"
        - "lastPeriod"
        - "variableNames"
        - "links"
      properties:
            tags:
              type: array
              items:
                type: string
                description: tag for table
              nullable: true
            updated:
              type: string
              description: Date and time when the figures in the table was last updated, in UTC time.
              pattern: "^((19|20)\\d\\d)\\-(0?[1-9]|1[012])\\-(0?[1-9]|[12][0-9]|3[01])$"
              format: date-time
              nullable: true
            firstPeriod:
              type: string
              description: First period
              example: 2017
              nullable: true
            lastPeriod:
              type: string
              description: Last period
              example: 2022
              nullable: true
            category:
              type: string
              description: Mostly for internal use. Which category table belongs to. internal, public, private or section. 
              default: public
              enum:
              - internal
              - public
              - private
              - section
            variableNames:
              type: array
              description: List of varibles name
              items:
                type: string
            discontinued:
              type: boolean
              nullable: true
            links:
              type: array
              items:
                $ref: '#/components/schemas/Link'
              description: Links to ...
              nullable: true

    PageInfo:
      type: object
      required:
        - "pageNumber"
        - "pageSize"
        - "totalElements"
        - "totalPages"
      properties:
        pageNumber:
          type: integer
          description: The current page number.
          format: int32
          minimum: 1
        pageSize:
          type: integer
          format: int32
          description: The maximal number of elements in a page
          example: 100
          minimum: 1
        totalElements:
          type: integer
          format: int32
          description: the Total number of elements
          minimum: 0
        totalPages:
          type: integer
          format: int32
          description: The total number of pages
          minimum: 1
        links:
          type: array
          items:
             $ref: '#/components/schemas/Link'

    TablesResponse:
      type: object
      required:
        - "tables"
        - "page"
      properties:
        tables:
          type: array
          items:
              $ref: '#/components/schemas/Table'    
        page:
          $ref: '#/components/schemas/PageInfo'
        links:
          type: array
          items:
             $ref: '#/components/schemas/Link'

    TableMetadata:
      type: object
      required: 
        - "id"
        - "label"
        - "variables"
        - "variablesDisplayOrder"
        - "links"
      properties:
        id:
          type: string
          description: Identifier for the table.
          example: "TAB0001"
        label:
          type: string
          description: A title for the table that describes the content of it.
          example: Corporations Financial Assets and Liabilities. Quarterly 1998K2 - 2021K4
        description:
          type: string
          description: A description of the table.
          example: Corporations Financial Assets and Liabilities by item. Quarterly 1998K2 - 2021K4 [2022-03-11]
        aggregationAllowed:
          type: boolean
          description: If all content of the table can be aggregated.
        officalStatistics:
          type: boolean
          description: A marker if the table is a part of the national official statistics.
        subjectCode:
          type: string
          description: The code for the subject area that the table belongs to.
          example: BE
        subjectLabel:
          type: string
          description: The label for the subject area that the table belongs to.
          example: Population
        source:
          type: string
          description: The name of the organization responsible for the table.
          example: Statistics Sweden
        licence:
          type: string
          description: A copyright statement for the data it could also be SPDX (https://spdx.org/licenses/) identifier
          example: CC0-1.0
        tags:
          type: array
          description: A list of strings/tags associated with the table
          items:
            type: string
        updated:
            type: string
            description: Date and time when the figures in the table was last updated, in UTC time.
            pattern: "^((19|20)\\d\\d)\\-(0?[1-9]|1[012])\\-(0?[1-9]|[12][0-9]|3[01])$"
            format: date-time
            nullable: true
        notes: 
          type: array
          description: A list of notes associated with the table as a whole or a specific area of the table
          items:
            $ref: '#/components/schemas/CellNote'
        contacts: 
          type: array
          description: A list of contacts associated with the table.
          items: 
            $ref: '#/components/schemas/Contact'
        variables:
          $ref: '#/components/schemas/AbstractVariable'
        variablesDisplayOrder:
          type: array
          items:
            type: string
        links: 
          type: array
          items:
            $ref: '#/components/schemas/Link'
    AbstractVariable:
      discriminator:
        propertyName: type
        mapping:
          ContentsVariable: "#/components/schemas/ContentsVariable"
          TimeVariable: "#/components/schemas/TimeVariable"
          GeographicalVariable: "#/components/schemas/GeographicalVariable"
          RegularVariable: "#/components/schemas/RegularVariable"          
      type: object
      required: 
        - id
        - label
        - type
      properties:
        id:
          type: string
          example: impex01
        label:
          type: string
          example: Import and export
        type: 
          type: string
          enum:
          - ContentsVariable
          - TimeVariable
          - GeographicalVariable
          - RegularVariable
        notes: 
          type: array
          items:
            $ref: '#/components/schemas/Note'
        links: 
          type: array
          items:
            $ref: '#/components/schemas/Link'
      
    Note:
      type: object
      required:
        - "text"
      properties:
        mandatory:
          type: boolean
          default: false
          description: Must be shown to end user if true
        text:
          type: string
    CellNote:
      allOf:
        - $ref: '#/components/schemas/Note'
      type: object
      description: Note for a table or a part of it
      properties:
        conditions:
          type: array
          description: A set of condition that must be fulfilled for the note to be valid. 
          items:
            $ref: '#/components/schemas/Condition'
          nullable: true
    Condition:
      description: Condition determining to what the CellNote applies
      type: object
      required:
        - "variable"
        - "value"
      properties:
        variable:
          type: string
          description: The code of the variable
        value:
          type: string
          description: The code of the value
    TimeVariable:
      description: Time variable
      allOf:
        - $ref: '#/components/schemas/AbstractVariable'
      type: object
      properties:
        timeUnit:
          description: Indicates the time scale for the variable.
          type: string
          default: Other
          enum:
            - Annual
            - HalfYear
            - Quarterly
            - Monthly
            - Weekly
            - Other
        firstPeriod:
          description: Earliest time period in table
          type: string
        lastPeriod:
          description: Latest time period in table
          type: string
        values:
          type: array
          items:
            $ref: '#/components/schemas/Value'
    ContentsVariable:
      description: Content variable
      allOf:
        - $ref: '#/components/schemas/AbstractVariable'
      type: object
      required:
        - "values"
      properties:
            values:
              type: array
              items:
                $ref: '#/components/schemas/ContentValue'
    AbstractCodeListVariable:
      description: Filter variable
      allOf:
      - $ref: '#/components/schemas/AbstractVariable'
      type: object
      required:
        - "values"
      properties:
        elimination:
          type: boolean
        eliminationValueCode:
          type: string
        values:
          type: array
          items:
            $ref: '#/components/schemas/Value'
        codeLists:
          $ref: '#/components/schemas/CodeLists'
    GeographicalVariable:
      allOf:
      - $ref: '#/components/schemas/AbstractCodeListVariable'
      type: object
      properties:
        map:
          type: string
    RegularVariable:
      description: All other type of variaiable except for time, contents or geographical
      allOf:
      - $ref: '#/components/schemas/AbstractCodeListVariable'
      type: object
    CodeListInformation:
      type: object
      required:
        - "id"
        - "label"
        - "links"
      properties:
        id:
          type: string
          description: The identity of the CodeList
        label:
          type: string
          description: A textual name for the CodeList
        links: 
          type: array
          description: Links to associated information about the code list
          items:
            $ref: '#/components/schemas/Link'
    Value:
      type: object
      required:
        - "code"
        - "label"
      properties:
        code: 
          type: string
          description: A code representing the value.
        label:
          type: string
          description: A Textual name for the value
        notes: 
          type: array
          description: Optional notes that are associated with the value
          items:
            $ref: '#/components/schemas/Note'
        links: 
          type: array
          items:
            $ref: '#/components/schemas/Link'
    ContentValue:
      allOf:
        - $ref: '#/components/schemas/Value'
      type: object
      description: Content value
      required:
            - unit
      properties:
            baseperiod:
              type: string
              nullable: true
            adjustment:
              type: string
              default: None
              enum:
              - None
              - SesOnly
              - WorkOnly
              - WorkAndSes
            measuringType:
              type: string
              default: Other
              enum:
              - Stock
              - Flow
              - Average
              - Other
            preferedNumberOfDecimals:
              type: integer
            priceType:
              type: string
              enum:
              - Current
              - Fixed
            unit:
              type: string
            refrencePeriod:
              type: string
    Contact:
      type: object
      required:
        - "raw"
      properties:
        name: 
          type: string
          example: Inga Svensson
        phone:
          type: string
          example: "+46101111111"
        mail:
          type: string
          example: testmail@testmail.com
        raw:
          type: string
          description: Raw contact information for compatability with PX files
    CodeListsResponse:
      type: object
      properties:
        language:
          type: string
          description: The language code for the language used in this response
          example: sv
        codeLists:
          type: array
          items:
            $ref: '#/components/schemas/CodeListMetadata'
        links: 
          type: array
          items:
            $ref: '#/components/schemas/Link'
    CodeListMetadata:
      type: object
      required:
        - "id"
        - "label"
        - "type"
        - "links"
      properties:
        id: 
          type: string
          description: The identiyer for the codelist
          example: agg_RegionNUTS2_2008
        label:
          type: string
          description: The textual name  for the codelist. 
          example: NUTS2 fr.o.m 2008
        type:
          $ref: '#/components/schemas/CodeListType'
        links: 
          type: array
          items:
            $ref: '#/components/schemas/Link'

    CodeListType:
      type: string
      description: Type of codelist
      enum:
        - Aggregation
        - Valueset

    CodeList: 
      type: object
      required:
        - "id"
        - "label"
        - "language"
        - "type"
        - "values"
        - "links"
      properties:
        id: 
          type: string
          description: The identiyer for the codelist
          example: agg_RegionNUTS2_2008
        label:
          type: string
          description: The textual name  for the codelist. 
          example: NUTS2 fr.o.m 2008 
        language:
          type: string
          description: The language code for the language used in this response
          example: sv
        type:
          $ref: '#/components/schemas/CodeListType'
        values:
          type: array
          items:
            $ref: '#/components/schemas/ValueMap'
        links: 
          type: array
          items:
            $ref: '#/components/schemas/Link'

    ValueMap:
      type: object
      required:
        - "code"
        - "label"
        - "valueMap"
      properties:
        code:
          type: string
          description: The code for the value.
          example: "SE22"
        label: 
          type: string
          description: The textual representation for the value
          example: Sydsverige
        valueMap:
          type: array
          description: An array of codes from the origial codelist for the variable that cand be mapped to this value
          example: '["10", "12"]'
          items:
            type: string
        notes: 
          type: array
          description: Optional notes that are associated with the value
          items:
            $ref: '#/components/schemas/Note'

    Link:
      type: object
      required:
        - "rel"
        - "hreflang"
        - "href"
      properties:
        rel:
          type: string
          nullable: false
          description: the link relation, see https://www.iana.org/assignments/link-relations/link-relations.xhtml
        hreflang:
          type: string
          description: The language that is used for the link, see https://moz.com/learn/seo/hreflang-tag
        href:
          type: string
          nullable: false
          description: the link to the resource

    Problem:
      type: object
      properties:
        type:
          type: string
          format: uri
          description: |
            An absolute URI that identifies the problem type.  When dereferenced,
            it SHOULD provide human-readable documentation for the problem type
            (e.g., using HTML).
          default: about:blank
          example: https://zalando.github.io/problem/constraint-violation
        title:
          type: string
          description: |
            A short, summary of the problem type. Written in english and readable
            for engineers (usually not suited for non technical stakeholders and
            not localized); example: Service Unavailable
        status:
          type: integer
          format: int32
          description: |
            The HTTP status code generated by the origin server for this occurrence
            of the problem.
          minimum: 100
          maximum: 600
          exclusiveMaximum: true
          example: 503
        detail:
          type: string
          description: |
            A human readable explanation specific to this occurrence of the
            problem.
          example: Connection to database timed out
        instance:
          type: string
          format: uri
          description: |
            An absolute URI that identifies the specific occurrence of the problem.
            It may or may not yield further information if dereferenced.
              
    strarray:
      type: array
      items:
        type: string
      uniqueItems: true
    updated:
      description: See https://json-stat.org/full/#updated
      type: string
      pattern: "^((19|20)\\d\\d)\\-(0?[1-9]|1[012])\\-(0?[1-9]|[12][0-9]|3[01])$"
    href:
      description: Specification on json-stat.org -> [here](https://json-stat.org/full/#href)
      type: string
      format: uri
    label:
      description: Specification on json-stat.org -> [here](https://json-stat.org/full/#label)
      type: string
    source:
      description: Specification on json-stat.org -> [here](https://json-stat.org/full/#source)
      type: string
    extension-root:
      description: extension at root level
      type: object
      properties:
        px:
          description: |
            Properties corresponds to keywords in the px-file.
            
            See [PX file format](https://www.scb.se/en/services/statistical-programs-for-px-files/px-file-format/)
          type: object
          properties:
            infofile:
              description: Name of a file containing more information for the statistics**
              type: string
            tableid:
              description: A text that is the identity of the table
              type: string
            decimals:
              description: The number of decimals in the table cells
              type: integer
            official-statistics:
              description: Indicates if the data table is included in the official statistics of the organization
              type: boolean
            aggregallowed:
              description: If the contents of the table cannot be aggregated
              type: boolean            
            copyright:
              description: Copyright is given as YES or NO
              type: string
            language:
              description: code (two characters) for language
              type: string
            description:
              description: See _description_ in [PX file format](https://www.scb.se/en/services/statistical-programs-for-px-files/px-file-format/)
              type: string
            matrix:
              description: The name of the matrix
              type: string
            subject-code:
              description: Subject area code
              type: string
            subject-area:
              description: Subject area
              type: string              
        tags:
          description: Tag for table
          type: array
          items: 
            type: string
        discontinued:
          description: Table will no longer be updated
          type: boolean
          nullable: true
        contact:
          type: array
          description: A list of contacts associated with the table.
          items: 
            $ref: '#/components/schemas/Contact'
        note:
          type: array
          items:
            $ref: '#/components/schemas/Note'
    extension:
      description: extension at some level
      type: object
    extension-dimension:
      description: extension at dimension
      type: object
      properties:
        elimination:
          description: Can dimension be elminated
          type: boolean
        eliminationValueCode:
          description: Elimination value code
          type: string
        refperiod:
          description: Text with information on the exact period for the statistics
          type: object
          additionalProperties:
            type: string
        show:
          description: Information about how variables are presented
          type: string
        note:
          description: Notes for dimension
          type: array
          items:
            $ref: '#/components/schemas/Note'
        valueNote:
          description: Notes for values in dimension.
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/Note'          
        codeLists:
         $ref: '#/components/schemas/CodeLists'
        frequency:
          description: How often a table is updated
          type: string
        firstPeriod:
          description: Earliest time period in table 
          type: string
        lastPeriod:
          description: Latest time period in table
          type: string
    strarray-by-str-dict:
       type: object
       additionalProperties:
          type: array
          items:
            type: string
          uniqueItems: true  
    jsonstat-link:
      type: object
      additionalProperties: 
        type: array
        items:
          type: object
          title: jsonstatLink
          properties:
            type:
              type: string  
            href:
              "$ref": "#/components/schemas/href"
          additionalProperties: false
    jsonstat-extension-link:
      type: object
      properties:
        describedby:
          type: array
          items:
            type: object
            title: DimensionExtension
            properties:
              extension:
                 description: A extension object
                 type: object
                 additionalProperties:
                    description: A string
                    type: string
                    
            additionalProperties: false       
      additionalProperties: false         

    jsonstat-category:
      type: object
      properties:
        index:
          description: Specification on json-stat.org -> [here](https://json-stat.org/full/#index)
          type: object
          additionalProperties:
            type: integer
        label:
          description: Specification on json-stat.org -> [here](https://json-stat.org/full/#label)
          type: object
          minProperties: 1
          additionalProperties:
            type: string
        child:
          description: Specification on json-stat.org -> [here](https://json-stat.org/full/#child)
          "$ref": "#/components/schemas/strarray-by-str-dict"
        unit:
          description: Specification on json-stat.org -> [here](https://json-stat.org/full/#unit)
          type: object
          additionalProperties:
            type: object
            properties:
              base:
                description: It is the base unit (person, gram, euro, etc.).
                type: string
              decimals:
                description: Number of decimals 
                type: integer
      additionalProperties: false
    CodeLists:
          description: Available codelists for this dimension
          type: array
          items:
            $ref: '#/components/schemas/CodeListInformation'
    Dataset:
      title: JSON-stat 2.0 Dataset Schema
      description: |
         Representation of TableMetaData/TableData according to JSON-stat 2.0 Dataset Schema (2018-09-05 10:55), see full specification of JSON-stat format [here](https://json-stat.org/full/)
         
         Properties in **extension** are mostly from PX-file format, see [PX file format](https://www.scb.se/en/services/statistical-programs-for-px-files/px-file-format/)
      type: object
      properties:
        version:
          description: JSON-stat version 2.0
          type: string
          enum:
            - '2.0'
          default: '2.0'      
        class:
          description: "Is always dataset"
          type: string
          enum:
            - dataset
          default: dataset
        href:
          "$ref": "#/components/schemas/href"
        label:
          "$ref": "#/components/schemas/label"
        source:
          "$ref": "#/components/schemas/source"
        updated:
          "$ref": "#/components/schemas/updated"
        link:
          "$ref": "#/components/schemas/jsonstat-link"
        role:
          description: Specification on json-stat.org -> [here](https://json-stat.org/full/#role)
          type: object
          properties:
            time:
              description: Specification on json-stat.org -> [here](https://json-stat.org/full/#time)
              "$ref": "#/components/schemas/strarray"
            geo:
              description: Specification on json-stat.org -> [here](https://json-stat.org/full/#geo)
              "$ref": "#/components/schemas/strarray"
            metric:
              description: Specification on json-stat.org -> [here](https://json-stat.org/full/#metric)
              "$ref": "#/components/schemas/strarray"
          additionalProperties: false  
        id:
          description: Specification on json-stat.org -> [here](https://json-stat.org/full/#id)
          "$ref": "#/components/schemas/strarray"
        size:
          description: Specification on json-stat.org -> [here](https://json-stat.org/full/#size)
          type: array
          items:
             type: integer
        dimension:
          description: Specification on json-stat.org -> [here](https://json-stat.org/full/#dimension)
          type: object
          additionalProperties:
             type: object
             properties:
              label:
                description: Specification on json-stat.org -> [here](https://json-stat.org/full/#label) 
                "$ref": "#/components/schemas/label"
              category:
                description: Specification on json-stat.org -> [here](https://json-stat.org/full/#category)
                "$ref": "#/components/schemas/jsonstat-category"  
              extension:
                "$ref": "#/components/schemas/extension-dimension"
              link:
                "$ref": "#/components/schemas/jsonstat-extension-link"
             additionalProperties: false            
        extension:
          "$ref": "#/components/schemas/extension-root"  
        value:
          description: Specification on json-stat.org -> [here](https://json-stat.org/full/#value)
          type: array
          nullable: true
          items:
            type: number
            format: double
            nullable: true
        status:
          description: Specification on json-stat.org -> [here](https://json-stat.org/full/#status)
          type: object
          additionalProperties:
            type: string
      additionalProperties: false
      required:
        - version
        - class
        - value
        - id
        - size
        - dimension
                   
  responses:
    ErrorResponse429:
      description: Error respsone for 429
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/Problem'
            #Reference: 
            # https://dzone.com/articles/rest-api-error-handling-problem-details-response
            # https://datatracker.ietf.org/doc/html/rfc7807
            # https://nordicapis.com/best-practices-api-error-handling/
          example:
            title: Too many requests
            status: 429
            detail: You have reach the threshold for request limiting. 30 request per minute.

    ErrorResponse400:
      description: Error respsone for 400
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/Problem'
          example:
            title: Bad Request
            status: 400
            detail: Value, xxx is not a valid value code for variable yyy


    ErrorResponse403:
      description: Error respsone for 403
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/Problem'
          example:
            title: Forbiden
            status: 403
            detail: The query resulted in cell that exceeds the number of allowed.

    ErrorResponse404:
      description: Error respsone for 404
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/Problem'
          example:
            title: Not Found
            status: 404
            detail: Node with id, xxx can not be found
            

  examples:  
    navigation-root:
      description: Example for 200 response for navigation endpoint
      value:
        id: 
        objectType: folder
        label: 
        description: 
        links:
        - rel: self
          href: https://my-site.com/api/v2/navigation
        folderContents:
        - id: JO
          objectType: folder
          label: Agriculture, forestry and fishery
          description: Animals, economy, employment, production, and more.
          links:
          - rel: self
            href: https://my-site.com/api/v2/navigation/JO
        - id: NV
          objectType: folder
          label: Financial markets
          description: Assets, banks, insurance companies, liabilities, shares, and more.
          links:
          - rel: self
            href: https://my-site.com/api/v2/navigation/NV

    navigation-be:
      description: Example for 200 response for navigation endpoint
      value:
        id: BE0101
        objectType: folder
        label: Balance statistics
        description: Balance statistics
        links:
        - rel: self
          href: https://my-site.com/api/v2/navigation/BE0101
        folderContents:
        - id: "01"
          objectType: folder-information
          label: Annual statistics
          description: Annual statistics
          links:
          - rel: folder
            href: https://my-site.com/api/v2/navigation/01
        - id: BEH1
          objectType: heading
          label: I am heading
          description: I am heading
        - id: TAB0001
          objectType: table
          label: Corporations Financial Assets and Liabilities. Quarterly 1998K2 - 2021K4
          description: Corporations Financial Assets and Liabilities by item. Quarterly 1998K2 - 2021K4 [2022-03-11]
          updated: 2017-09-08T19:01:55.714942+03:00
          categoy: 'O'
          tags: 
          - Money
          - Gold
          links:
          - rel: self
            href: https://my-site.com/api/v2/tables/TAB0001
          - rel: metadata
            href: https://my-site.com/api/v2/tables/TAB0001/metadata
          - rel: data
            href: https://my-site.com/api/v2/tables/TAB0001/data
          variablesName:
            - observations
            - region
            - marital status
            - age
          firstPeriod: 1998K2
          lastPeriod: 2021K4
          discontinued: false
    tablesResponse:
      description: List all tables with pagination
      value:
        tables: 
          - id: TAB0001
            objectType: table
            label: Population. Year 1968 - 2021
            description: Population by region, marital status, age and sex. Year 1968 - 2021
            updated: 2017-09-08T19:01:55.714942+03:00
            categoy: 'O'
            tags: []
            links:
            - rel: self
              href: https://my-site.com/api/v2/tables/TAB0001
            - rel: metadata
              href: https://my-site.com/api/v2/tables/TAB0001/metadata
            - rel: data
              href: https://my-site.com/api/v2/tables/TAB0001/data
            variablesName:
              - observations
              - region
              - marital status
              - age
            firstPeriod: 1968
            lastPeriod: 2021
            discontinued: false
          - id: TAB0001
            objectType: table
            label: Tabell A
            description: Folkmängd, in- och utvanding, medellivslängd, namn, prognoser mm
            updated: 2017-09-08T19:01:55.714942+03:00
            categoy: 'O'
            tags: []
            links:
            - rel: self
              href: https://my-site.com/api/v2/tables/TAB0001
            - rel: metadata
              href: https://my-site.com/api/v2/tables/TAB0001/metadata
            - rel: data
              href: https://my-site.com/api/v2/tables/TAB0001/data
            variablesName:
              - observations
              - region
              - marital status
              - age
            firstPeriod: 2017
            lastPeriod: 2022
            discontinued: false
        page:
          pageNumber: 10
          pageSize: 100
          totalElements: 7000
          totalPages: 70
        links:
          - rel: self
            href: https://my-site.com/api/v2/tables/?pageNumber=10
          - rel: first
            href: https://my-site.com/api/v2/tables/?pageNumber=1
          - rel: last
            href: https://my-site.com/api/v2/tables/?pageNumber=70
          - rel: next
            href: https://my-site.com/api/v2/tables/?pageNumber=11
          - rel: prev
            href: https://my-site.com/api/v2/tables/?pageNumber=9  
